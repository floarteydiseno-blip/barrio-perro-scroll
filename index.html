<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Barrio Perro ‚Äì Reveal on Scroll (centrado)</title>
  <style>
    :root{
      /* Color del overlay (pantalla) */
      --overlay: #000000;

      /* Tama√±o base del hueco (logo) ‚Äî AJUSTA AQU√ç */
      --holeBase: 5vmin;   /* m√°s peque√±o que antes para que no se vea enorme */

      /* Offsets finos del hueco ‚Äî AJUSTA SI LO VES CORRIDO */
      --dx: 0vmin;          /* + derecha / - izquierda */
      --dy: .15vmin;          /* + abajo / - arriba LO CAMBIE DE 0 = A .15*/

      /* Escala din√°mica (la cambia el scroll) */
      --k: 1;
    }

    html, body{
      margin: 0;
      height: 540vh;    /*var(--docH, 300vh); /* deja ‚Äúcamino‚Äù para scrollear lo cambi√© de 220 a 360 de nuevo*/
      background: #000;
    }

    /* Video fijo al fondo */
    #video-bg{
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: 1;
      background:#000;
    }

    /* Overlay SVG que tapa TODO y recorta el hueco del logo */
    svg#overlay{
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      z-index: 2;
      pointer-events: none; /* no bloquea el scroll */
      display: block;
    }

    /* ====== TEXTO EN HERO ====== */
#headline{
  position: fixed;
  inset: 0;
  z-index: 3;                 /* por encima del video/overlay */
  display: grid;
  place-items: center;
  pointer-events: none;
  opacity: 0;
  transform: translateY(12px);
  transition: opacity .5s ease, transform .6s ease;
}

#headline .line{
  max-width: min(90vw, 1100px);
  text-align: center;
  line-height: 1.08;
  color: #fff;
  font-size: clamp(24px, 6.5vmin, 64px);
  font-weight: 700;
  letter-spacing: .2px;
}

/* cuando el logo ya ‚Äúabri√≥‚Äù, mostramos el titular */
body.open #headline{
  opacity: 1;
  transform: translateY(0);
}

/* ====== SECCI√ìN SIGUIENTE (REVEAL) ====== */
.section{
  position: relative;
  z-index: 4;                 /* video/overlay ya quedaron atr√°s */
  min-height: 120dvh;
  display: grid;
  place-items: center;
  padding: clamp(24px, 6vmin, 96px);
  background: #000;           /* continuidad visual */
}

.reveal{
  max-width: min(90vw, 1100px);
  color: #fff;
  text-align: center;
  font-size: clamp(24px, 6vmin, 56px);
  line-height: 1.12;
  opacity: 0;
  transform: translateY(42px);
  transition: transform .8s cubic-bezier(.2,.7,0,.99), opacity .6s ease;
}

.reveal.in{
  opacity: 1;
  transform: translateY(0);
}

/* Respeto a usuarios que prefieren menos movimiento */
@media (prefers-reduced-motion: reduce){
  #headline, .reveal{
    transition: none;
    transform: none !important;
    opacity: 1 !important;
  }
}

  </style>
</head>
<body>

  <!-- Video de fondo -->
  <video id="video-bg" autoplay muted loop playsinline preload="auto" poster="poster.jpg">
    <source src="HERO.mp4" type="video/mp4" />
  </video>

  <!-- Overlay con m√°scara ‚Äúknockout‚Äù: blanco=tapa, negro=hueco -->
  <svg id="overlay" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid slice" aria-hidden="true">  /*CAMBIO/*
    <defs>
      <!-- Usamos unidades del viewport para tener control fino (px/vmin) -->
      <mask id="revealMask" maskUnits="userSpaceOnUse" maskContentUnits="userSpaceOnUse">
        <!-- Fondo blanco: mantiene visible todo el overlay negro -->
        <rect x="0" y="0" width="100vw" height="100vh" fill="white"/>
        <!-- Logo NEGRO (fondo TRANSPARENTE) centrado y escalable -->
        <!-- Si tu logo sigue vi√©ndose corrido: ajusta --dx y --dy -->
        <image
          href="logo-mask.svg"
          x="50%" y="50%"
          preserveAspectRatio="xMidYMid meet"
          style="
            width:  var(--holeBase);
            height: var(--holeBase);
            transform:
              translate(calc(-50% + var(--dx)), calc(-50% + var(--dy)))
              scale(var(--k));
            transform-box: fill-box;
            transform-origin: 50% 50%;
          " />
      </mask>
    </defs>

    <!-- Rect√°ngulo negro que tapa todo; la m√°scara abre el hueco del logo -->
    <rect x="0" y="0" width="100%" height="100%" fill="var(--overlay)" mask="url(#revealMask)"/>
  </svg>

  <!-- Texto que aparece cuando el logo ya abri√≥ -->
<div id="headline" aria-hidden="true">
  <h1 class="line">
    Barrio Perro es m√°s que una tienda: <br/>
    es un refugio natural para perros urbanos.
  </h1>
</div>

<!-- Siguiente ‚Äúpantalla‚Äù con efecto reveal desde abajo -->
<section class="section">
  <h2 class="reveal">
    Barrio Perro es m√°s que una tienda: es un refugio natural para perros urbanos.
  </h2>
</section>
  
  <script>
    (function(){
      const root = document.documentElement;

      // üìè L√≠mites y sensibilidad del crecimiento del hueco
      const MIN = 1.0;      // escala m√≠nima (hueco chico al inicio)
      const MAX = 18;      // escala m√°xima cambi√≥ de 12 A 20
      const SPEED = 0.008;  // sensibilidad del scroll
      const overlay = document.getElementById('overlay');
      const OPEN_EPS = 0.05; 

      function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }
    
      function onScroll(){
        const y = window.scrollY || document.documentElement.scrollTop || 0;
        const k = Math.max(MIN, Math.min(MAX, MIN + y * SPEED));
        //root.style.setProperty('--k', String(k));
         document.documentElement.style.setProperty('--k', String(k));

    if (k >= MAX - OPEN_EPS) {
      document.body.classList.add('open');
      overlay.style.opacity = '0';
    } else {
      document.body.classList.remove('open');
      overlay.style.opacity = '1';
    }
      }

      /* Inicializa y escucha scroll
      onScroll();
      window.addEventListener('scroll', onScroll, { passive: true });

      /* (Opcional) fade-out del overlay cuando llega al m√°ximo 
      //const overlay = document.getElementById('overlay');
      overlay.style.transition = 'opacity .5s ease';
      window.addEventListener('scroll', () => {
        const y = window.scrollY || 0;
        const k = Math.max(MIN, Math.min(MAX, MIN + y * SPEED));
        overlay.style.opacity = (k >= MAX - 0.5) ? '0' : '1';     //le quit√© el >=-0.5
      }, { passive:true });
    })();*/

    // === IntersectionObserver para el reveal ===
  const io = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting) e.target.classList.add('in');
    });
  }, { threshold: 0.15, rootMargin: '0px 0px -10%' });

  document.querySelectorAll('.reveal').forEach(el => io.observe(el));
    
// Aseg√∫rate de llamar a onScroll al cargar para fijar el estado inicial
window.addEventListener('scroll', onScroll, { passive: true });
window.addEventListener('load', onScroll);
    
})(); 
    
  </script>
</body>
</html>
