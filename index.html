<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Barrio Perro – Reveal on Scroll (centrado)</title>

  <!-- Fuentes -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">

  <style>
    :root{
      --overlay: #000000;
      --holeBase: 5vmin;      /* tamaño base del logo/hueco */
      --dx: 0vmin;            /* ajuste fino X */
      --dy: .15vmin;          /* ajuste fino Y (lo tenías así) */
      --k: 1;                 /* escala dinámica (JS) */
    }

    html, body{
      margin: 0;
      height: 540vh;          /* recorrido para scrollear */
      background: #000;
      overflow-x: hidden;
    }

    /* Video fijo al fondo */
    #video-bg{
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: 1;
      background:#000;
    }

    /* Overlay con máscara */
    svg#overlay{
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      z-index: 2;
      pointer-events: none;
      display: block;
      transition: opacity .5s ease; /* fade controlado por JS */
    }

    /* ====== TEXTO EN HERO ====== */
    #headline{
      position: fixed;
      inset: 0;
      z-index: 3;                 /* por encima del overlay */
      display: grid;
      align-items: end;           /* pegado abajo */
      justify-items: center;
      padding-bottom: clamp(24px, 8vmin, 120px);
      pointer-events: none;
    }

    #headline .line{
      font-family: 'Bebas Neue', sans-serif;
      font-weight: 400;
      letter-spacing: .5px;
      text-transform: uppercase;

      max-width: min(90vw, 1100px);
      text-align: center;
      color: #fff;
      font-size: clamp(26px, 6.8vmin, 68px);
      line-height: 1.05;

      /* estado inicial: abajo y oculto */
      opacity: 0;
      transform: translateY(12vh);
      transition: transform .7s cubic-bezier(.2,.7,0,.99), opacity .6s ease;
    }

    /* FIX: selector correcto (sin el punto extra) */
    body.open #headline .line{
      opacity: 1;
      transform: translateY(0);
    }

    /* ====== SECCIÓN SIGUIENTE (REVEAL) ====== */
    .section{
      position: relative;
      z-index: 4;
      min-height: 120dvh;
      display: grid;
      place-items: center;
      padding: clamp(24px, 6vmin, 96px);
      background: #000;
    }

    .reveal{
      max-width: min(90vw, 1100px);
      color: #fff;
      text-align: center;
      font-size: clamp(24px, 6vmin, 56px);
      line-height: 1.12;
      opacity: 0;
      transform: translateY(42px);
      transition: transform .8s cubic-bezier(.2,.7,0,.99), opacity .6s ease;
    }

    .reveal.in{
      opacity: 1;
      transform: translateY(0);
    }

    @media (prefers-reduced-motion: reduce){
      .reveal{
        transition: none;
        transform: none !important;
        opacity: 1 !important;
      }
    }
  </style>
</head>
<body>

  <!-- Video de fondo -->
  <video id="video-bg" autoplay muted loop playsinline preload="auto" poster="poster.jpg">
    <source src="HERO.mp4" type="video/mp4" />
  </video>

  <!-- Overlay con máscara “knockout”: blanco=tapa, negro=hueco -->
  <!-- FIX: usa comentarios HTML, no /* ... */ dentro del SVG -->
 
  <svg id="overlay" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid slice" aria-hidden="true">
  <defs>
    <mask id="revealMask">
      <!-- Fondo blanco: visible -->
      <rect x="0" y="0" width="100" height="100" fill="white"/>
      <!-- Logo negro: abre hueco -->
      <image
        href="logo-mask.svg"
        x="50" y="50"
        width="20" height="20"
        preserveAspectRatio="xMidYMid meet"
        style="
          transform: translate(calc(-50% + var(--dx)), calc(-50% + var(--dy)))
                     scale(var(--k));
          transform-box: fill-box;
          transform-origin: 50% 50%;
        "
        fill="black"/>
    </mask>
  </defs>

  <!-- Rectángulo negro con máscara -->
  <rect x="0" y="0" width="100%" height="100%" fill="var(--overlay)" mask="url(#revealMask)"/>
</svg>

  <!-- Texto que aparece cuando el logo ya abrió -->
  <div id="headline" aria-hidden="true">
    <h1 class="line">
      Barrio Perro es más que una tienda: <br/>
      es un refugio natural para perros urbanos.
    </h1>
  </div>

  <!-- Siguiente “pantalla” con efecto reveal desde abajo -->
  <section class="section">
    <h2 class="reveal">
      Barrio Perro es más que una tienda: es un refugio natural para perros urbanos.
    </h2>
  </section>

  <script>
  (function(){
    /* ===== Parámetros de apertura ===== */
    const MIN = 1.0;     // escala mínima del logo/hueco
    const MAX = 18;      // escala máxima (lo tenías en 18)
    const SPEED = 0.008; // sensibilidad del scroll
    const OPEN_EPS = 0.05;

    const overlay = document.getElementById('overlay');

    // ===== Utilidad =====
    function clamp(v,a,b){ return Math.max(a, Math.min(b, v)); }

    // ===== Scroll principal: sincroniza apertura + texto =====
    function onScroll(){
      const y = window.scrollY || document.documentElement.scrollTop || 0;
      const k = clamp(MIN + y * SPEED, MIN, MAX);

      // Actualiza escala del “agujero”
      document.documentElement.style.setProperty('--k', String(k));

      // Estado abierto/cerrado
      const opened = (k >= MAX - OPEN_EPS);

      // Fade del overlay y entrada del titular (desde abajo)
      overlay.style.opacity = opened ? '0' : '1';

      // Retardo sutil para que termine el fade del overlay
      if (opened) {
        setTimeout(() => document.body.classList.add('open'), 80);
      } else {
        document.body.classList.remove('open');
      }
    }

    // Listeners (NO duplicar)
    window.addEventListener('scroll', onScroll, { passive: true });
    window.addEventListener('load', onScroll);

    // ===== Reveal “desde abajo” en la sección siguiente =====
    const io = new IntersectionObserver((entries) => {
      entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('in'); });
    }, { threshold: 0.15, rootMargin: '0px 0px -10%' });

    document.querySelectorAll('.reveal').forEach(el => io.observe(el));
  })();
  </script>
</body>
</html>
